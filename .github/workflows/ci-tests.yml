name: Poprawne zarzÄ…dzanie powÅ‚okami w kontenerach
on: [push]

jobs:
  shell_progression:
    runs-on: ubuntu-latest
    container: alpine:latest

    steps:
      - name: Instalacja bash uÅ¼ywajÄ…c sh
        # Nie ustawiamy `shell: bash` - uÅ¼ywamy domyÅ›lnej powÅ‚oki sh
        run: |
          echo "ğŸ”§ InstalujÄ™ bash uÅ¼ywajÄ…c powÅ‚oki sh..."
          # W Alpine Linux sh jest dostÄ™pne domyÅ›lnie
          apk add --no-cache bash
          echo "âœ… Bash zostaÅ‚ zainstalowany"
          
          # SprawdÅºmy czy bash jest teraz dostÄ™pny
          which bash && echo "ğŸ¯ Bash znaleziony w: $(which bash)"
          
          # SprawdÅºmy wersjÄ™ bash
          bash --version | head -1

      - name: Teraz moÅ¼emy uÅ¼ywaÄ‡ bash globalnie
        shell: bash  # Teraz bash jest juÅ¼ zainstalowany, wiÄ™c moÅ¼emy go uÅ¼ywaÄ‡
        run: |
          echo "ğŸš Testowanie zaawansowanych funkcji bash:"
          
          # Tablice - funkcja dostÄ™pna tylko w bash
          fruits=("apple" "banana" "cherry" "date")
          echo "Lista owocÃ³w: ${fruits[@]}"
          echo "Pierwszy owoc: ${fruits[0]}"
          echo "Liczba owocÃ³w: ${#fruits[@]}"
          
          # Zaawansowane rozwijanie zmiennych
          filename="report.txt"
          echo "PeÅ‚na nazwa: $filename"
          echo "Nazwa bez rozszerzenia: ${filename%.txt}"
          echo "Tylko rozszerzenie: ${filename##*.}"
          
          # Operator sprawdzania plikÃ³w specyficzny dla bash
          [[ -f "/.dockerenv" ]] && echo "âœ… Jestem w kontenerze Docker" || echo "âŒ Nie jestem w kontenerze"
          
          # Test zÅ‚oÅ¼onych warunkÃ³w bash
          [[ ${#fruits[@]} -gt 3 ]] && echo "âœ… Mamy wiÄ™cej niÅ¼ 3 owoce" || echo "âŒ Mamy 3 lub mniej owocÃ³w"

      - name: PorÃ³wnanie z sh dla edukacji
        shell: sh  # Celowo uÅ¼ywamy sh Å¼eby pokazaÄ‡ rÃ³Å¼nice
        run: |
          echo "ğŸ”§ Uruchamiam w sh - podstawowa funkcjonalnoÅ›Ä‡ POSIX:"
          
          # W sh nie moÅ¼emy uÅ¼ywaÄ‡ tablic jak w bash
          # fruits=("apple" "banana")  # To by nie dziaÅ‚aÅ‚o w sh!
          
          # Zamiast tego uÅ¼ywamy prostych zmiennych
          fruits="apple banana cherry date"
          echo "Owoce jako string: $fruits"
          
          # Podstawowe sprawdzanie plikÃ³w (kompatybilne z POSIX)
          if [ -f "/.dockerenv" ]; then
            echo "âœ… W kontenerze (sprawdzenie kompatybilne z sh)"
          else
            echo "âŒ Poza kontenerem"
          fi
          
          # Pokazanie rÃ³Å¼nic w skÅ‚adni
          echo "ğŸ“ RÃ³Å¼nice miÄ™dzy sh a bash:"
          echo "- sh: uÅ¼ywa [ ] do warunkÃ³w"
          echo "- bash: moÅ¼e uÅ¼ywaÄ‡ [[ ]] z dodatkowymi funkcjami"
          echo "- sh: nie ma tablic"
          echo "- bash: ma zaawansowane tablice i funkcje string"