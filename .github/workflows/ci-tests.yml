name: Zarządzanie powłokami w kontenerach
on: [push]

jobs:
  shell_comparison:
    runs-on: ubuntu-latest
    container: alpine:latest  # Alpine Linux używa sh jako domyślnej powłoki

    # Globalne ustawienie powłoki dla wszystkich kroków w tym zadaniu
    defaults:
      run:
        shell: bash

    steps:
      - name: Instalacja bash w Alpine (jeśli potrzeba)
        run: |
          # Alpine domyślnie ma tylko sh, więc instalujemy bash
          apk add --no-cache bash
          echo "✅ Bash został zainstalowany"

      - name: Test funkcji bash (dzięki globalnej konfiguracji)
        run: |
          # Te funkcje działają tylko w bash, nie w sh
          echo "🐚 Testowanie zaawansowanych funkcji bash:"
          
          # Tablice (niedostępne w sh)
          fruits=("apple" "banana" "cherry")
          echo "Owoce: ${fruits[@]}"
          
          # Zaawansowane rozwijanie zmiennych
          filename="report.txt"
          echo "Nazwa bez rozszerzenia: ${filename%.txt}"
          
          # Operatory logiczne bash
          [[ -f "/.dockerenv" ]] && echo "✅ W kontenerze" || echo "❌ Poza kontenerem"

      - name: Przykład z lokalnym przełącznikiem powłoki
        shell: sh  # Ten konkretny krok używa sh mimo globalnej konfiguracji bash
        run: |
          # Kod kompatybilny z sh (podstawowa powłoka POSIX)
          echo "🔧 Uruchamiam w sh - podstawowa funkcjonalność:"
          echo "Zmienna HOME: $HOME"
          echo "Lista plików:"
          ls -la /
          
          # Unikamy funkcji specyficznych dla bash
          if [ -f "/.dockerenv" ]; then
            echo "✅ W kontenerze (sprawdzenie kompatybilne z sh)"
          fi
