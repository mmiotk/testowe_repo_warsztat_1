name: Kontrolowana sekwencja zadań
on: [push]

jobs:
  validate_code:
    name: "Walidacja kodu źródłowego"
    runs-on: ubuntu-latest
    steps:
      - name: Sprawdź składnię i styl
        run: |
          echo "🔍 Walidacja kodu: sprawdzanie składni, ESLint, Prettier"
          echo "Czas rozpoczęcia: $(date '+%H:%M:%S')"
          sleep 15
          echo "✅ Kod jest poprawny i zgodny ze standardami"

  run_tests:
    name: "Wykonanie testów"
    needs: validate_code    # Czeka na zakończenie validate_code
    runs-on: ubuntu-latest
    steps:
      - name: Testy jednostkowe i integracyjne
        run: |
          echo "🧪 Uruchamianie testów po pomyślnej walidacji"
          echo "Czas rozpoczęcia: $(date '+%H:%M:%S')"
          sleep 25
          echo "✅ Wszystkie testy przeszły pomyślnie"

  build_artifacts:
    name: "Budowanie artefaktów"
    needs: run_tests       # Czeka na zakończenie run_tests
    runs-on: ubuntu-latest
    steps:
      - name: Kompilacja i pakowanie
        run: |
          echo "🏗️ Budowanie aplikacji po pomyślnych testach"
          echo "Czas rozpoczęcia: $(date '+%H:%M:%S')"
          sleep 20
          echo "✅ Artefakty zostały zbudowane"

  deploy_staging:
    name: "Wdrożenie na staging"
    needs: build_artifacts # Czeka na zakończenie build_artifacts
    runs-on: ubuntu-latest
    steps:
      - name: Wdrożenie na środowisko testowe
        run: |
          echo "🚀 Wdrażanie na staging po zbudowaniu artefaktów"
          echo "Czas rozpoczęcia: $(date '+%H:%M:%S')"
          sleep 10
          echo "✅ Aplikacja wdrożona na staging"
